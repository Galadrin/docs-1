(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{664:function(e,t,a){"use strict";a.r(t);var o=a(0),i=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"writing-a-custom-storage-integration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#writing-a-custom-storage-integration"}},[e._v("#")]),e._v(" Writing a custom storage integration")]),e._v(" "),a("p",[e._v("To enable integrations to use a different place to store the data, you have to write your custom storage integration and\nextend\nthe "),a("a",{attrs:{href:"https://github.com/KYVENetwork/node/blob/refactoring/common/core/src/types/interfaces/storageProvider.interface.ts",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("IStorageProvider")]),a("OutboundLink")],1),e._v("\nclass. The interface is well-documented and requires you to overwrite a few functions:")]),e._v(" "),a("p",[e._v("First, instantiate an empty class, which implements the interface")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGNsYXNzIE15Q3VzdG9tU3RvcmFnZVByb3ZpZGVyIGltcGxlbWVudHMgSVN0b3JhZ2VQcm92aWRlciB7Cn0K"}}),e._v(" "),a("p",[e._v("Secondly, overwrite the "),a("code",[e._v("name")]),e._v(" and "),a("code",[e._v("decimals")]),e._v(" fields.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGNsYXNzIE15Q3VzdG9tU3RvcmFnZVByb3ZpZGVyIGltcGxlbWVudHMgSVN0b3JhZ2VQcm92aWRlciB7CiAgcHVibGljIG5hbWUgPSAmcXVvdDtNeUN1c3RvbVN0b3JhZ2VQcm92aWRlciZxdW90OzsKICBwdWJsaWMgZGVjaW1hbHMgPSA5Owp9Cg=="}}),e._v(" "),a("p",[e._v("Then create a constructor which takes in a private key to access the underlying wallet of your integration. Note: When\nusing KYSOR to run the runtime later, this key will be accessible through the key ring.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGNsYXNzIE15Q3VzdG9tU3RvcmFnZVByb3ZpZGVyIGltcGxlbWVudHMgSVN0b3JhZ2VQcm92aWRlciB7CiAgcHVibGljIG5hbWUgPSAmcXVvdDtNeUN1c3RvbVN0b3JhZ2VQcm92aWRlciZxdW90OzsKICBwdWJsaWMgZGVjaW1hbHMgPSA5OwoKICBpbml0KHN0b3JhZ2VQcml2OiBzdHJpbmcpIHsKICAgIC8vIGluaXQgeW91ciBjbGllbnQgZm9yIHRoZSBzdG9yYWdlIHByb3ZpZGVyIGhlcmUKICAgIHJldHVybiB0aGlzOwogIH0KfQo="}}),e._v(" "),a("p",[e._v("In the last step, overwrite the three main functions.")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("getBalance(): Promise<string>")]),e._v(" should return the wallet's current balance. This function is used to avoid problems\nwith empty wallets")]),e._v(" "),a("li",[a("code",[e._v("saveBundle(bundle: Buffer, tags: [string, string][]): Promise<string>")]),e._v(" this function specifies how data is stored on\nyour storage provider. It also gives you a couple of tags you can optionally add to the transaction to make it easier\nto retrieve via external indexers. Please note that using the tagging is entirely optional. Make sure to return a\nunique ID that points to the bundle to be able to retrieve it later on.")]),e._v(" "),a("li",[a("code",[e._v("retrieveBundle(storageId: string, timeout: number): Promise<Buffer>")]),e._v(" specify how to load a bundle from the storage\nprovider using the ID. This id will be of the type that got returned in the "),a("code",[e._v("saveBundle")]),e._v("-function. You also specify a\ntimeout after which the function should abort to avoid future problems in case the storage provider is inaccessible")])]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGNsYXNzIE15Q3VzdG9tU3RvcmFnZVByb3ZpZGVyIGltcGxlbWVudHMgSVN0b3JhZ2VQcm92aWRlciB7CiAgcHVibGljIG5hbWUgPSAmcXVvdDtNeUN1c3RvbVN0b3JhZ2VQcm92aWRlciZxdW90OzsKICBwdWJsaWMgZGVjaW1hbHMgPSA5OwoKICBpbml0KHN0b3JhZ2VQcml2OiBzdHJpbmcpIHsKICAgIC8vIGluaXQgeW91ciBjbGllbnQgdG8gdGhlIHN0b3JhZ2UgZW5kcG9pbnQgaGVyZQogICAgdGhpcy5leGFtcGxlV2FsbGV0ID0gaW5pdFdhbGxldChzdG9yYWdlUHJpdikKICAgIHJldHVybiB0aGlzOwogIH0KCiAgYXN5bmMgZ2V0QmFsYW5jZSgpIHsKICAgIC8vIHNwZWNpZnkgaG93IHRvIHJldHJpZXZlIHRoZSBiYWxhbmNlIGZyb20gdGhlICB3YWxsZXQKICAgIHJldHVybiBhd2FpdCB0aGlzLmV4YW1wbGVXYWxsZXQuZ2V0QmFsYW5jZSgpOwogIH0KCiAgYXN5bmMgc2F2ZUJ1bmRsZShidW5kbGU6IEJ1ZmZlciwgdGFnczogW3N0cmluZywgc3RyaW5nXVtdKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGF3YWl0IHRoaXMuZXhtYXBsZUNsaWVudC5zYXZlRGF0YSh7IGRhdGE6IGJ1bmRsZSwgfSk7CiAgICByZXR1cm4gdHJhbnNhY3Rpb24uaWQ7CiAgfQoKICBhc3luYyByZXRyaWV2ZUJ1bmRsZShzdG9yYWdlSWQ6IHN0cmluZywgdGltZW91dDogbnVtYmVyKSB7CiAgICAvLyBUaGlzIGlzIGFuIGV4YW1wbGUgaW1wbGVtZW50YXRpb24gb2Ygc29tZSAKICAgIC8vIG1hZGUtdXAgc3RvcmFnZSBwcm92aWRlcgogICAgY29uc3QgeyBkYXRhOiBidW5kbGUgfSA9IGF3YWl0IGF4aW9zLmdldCgKICAgICAgYGh0dHBzOi8vbXlleGFtcGxlc3RvcmFnZXByaXZkZXIubmV0LyR7c3RvcmFnZUlkfWAsCiAgICAgIHsgcmVzcG9uc2VUeXBlOiAmcXVvdDthcnJheWJ1ZmZlciZxdW90OywgdGltZW91dCB9CiAgICApOwogICAgcmV0dXJuIGJ1bmRsZTsKICB9Cn0K"}}),e._v(" "),a("p",[e._v("Here is an example of\nthe "),a("a",{attrs:{href:"https://github.com/KYVENetwork/node/blob/refactoring/common/core/src/storage/Arweave.ts",target:"_blank",rel:"noopener noreferrer"}},[e._v("Arweave-Storage-Provider"),a("OutboundLink")],1)])],1)}),[],!1,null,null,null);t.default=i.exports}}]);